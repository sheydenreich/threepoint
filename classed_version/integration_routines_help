double A96[96]={                   /* abscissas for 96-point Gauss quadrature */
  0.016276744849603,0.048812985136050,0.081297495464426,0.113695850110666,
  0.145973714654897,0.178096882367619,0.210031310460567,0.241743156163840,
  0.273198812591049,0.304364944354496,0.335208522892625,0.365696861472314,
  0.395797649828909,0.425478988407301,0.454709422167743,0.483457973920596,
  0.511694177154668,0.539388108324358,0.566510418561397,0.593032364777572,
  0.618925840125469,0.644163403784967,0.668718310043916,0.692564536642172,
  0.715676812348968,0.738030643744400,0.759602341176648,0.780369043867433,
  0.800308744139141,0.819400310737932,0.837623511228187,0.854959033434602,
  0.871388505909297,0.886894517402421,0.901460635315852,0.915071423120898,
  0.927712456722309,0.939370339752755,0.950032717784438,0.959688291448743,
  0.968326828463264,0.975939174585137,0.982517263563015,0.988054126329624,
  0.992543900323763,0.995981842987209,0.998364375863182,0.999689503883231};

double W96[96]={                     /* weights for 96-point Gauss quadrature */
  0.032550614492363,0.032516118713869,0.032447163714064,0.032343822568576,
  0.032206204794030,0.032034456231993,0.031828758894411,0.031589330770727,
  0.031316425596861,0.031010332586314,0.030671376123669,0.030299915420828,
  0.029896344136328,0.029461089958168,0.028994614150555,0.028497411065085,
  0.027970007616848,0.027412962726029,0.026826866725592,0.026212340735672,
  0.025570036005349,0.024900633222484,0.024204841792365,0.023483399085926,
  0.022737069658329,0.021966644438744,0.021172939892191,0.020356797154333,
  0.019519081140145,0.018660679627411,0.017782502316045,0.016885479864245,
  0.015970562902562,0.015038721026995,0.014090941772315,0.013128229566962,
  0.012151604671088,0.011162102099839,0.010160770535008,0.009148671230783,
  0.008126876925699,0.007096470791154,0.006058545504236,0.005014202742928,
  0.003964554338445,0.002910731817935,0.001853960788947,0.000796792065552};

double GQ96(double F(double),double a,double b)
  { /* 96-pt Gauss qaudrature integrates F(x) from a to b */
  int i;
  double cx,dx,q;
  cx=(a+b)/2;
  dx=(b-a)/2;
  q=0;
  for(i=0;i<48;i++)
    q+=W96[i]*(F(cx-dx*A96[i])+F(cx+dx*A96[i]));
  return(q*dx);
  }

double GQ96ZI(double F(double))
{ /* 96-pt Gauss qaudrature integrates F(x) from 0 to infinity */
    int i;
    double q,x,y;
    q=0;
    for(i=0;i<48;i++)
    {
        y=1./(.5-A96[i]/2);
        x=log(y);
        q+=W96[i]*y*F(x);
        y=1./(.5+A96[i]/2);
        x=log(y);
        q+=W96[i]*y*F(x);
    }
    return(q/2);
}


double GQ962D(double F(double,double),double x1,double x2, double y1,double y2)
{/* 96x96-pt 2-D Gauss qaudrature integrates
            F(x,y) over [x1,x2] x [y1,y2] */
    int i,j,k;
    double cx,cy,dx,dy,q,w,x;
    cx=(x1+x2)/2;
    dx=(x2-x1)/2;
    cy=(y1+y2)/2;
    dy=(y2-y1)/2;
    q=0;
    for(i=0;i<48;i++)
    {
    for(k=-1;k<=1;k+=2)
        {
        x=cx+k*dx*A96[i];
        w=dy*W96[i];
        for(j=0;j<48;j++)
        q+=w*W96[j]*(F(x,cy-dy*A96[j])+F(x,cy+dy*A96[j]));
        }
    }
    return(q*dx);
}